<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Flow matching generative model | Minh-Tuan Bui </title> <meta name="author" content="Minh-Tuan Bui"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/site/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/site/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/site/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/site/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/site/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://mtuanbui.github.io/site/blog/2025/cfm/"> <script src="/site/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/site/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/site/assets/js/distillpub/template.v2.js"></script> <script src="/site/assets/js/distillpub/transforms.v2.js"></script> <script src="/site/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Flow matching generative model",
            "description": "",
            "published": "January 23, 2025",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/site/"> <span class="font-weight-bold">Minh-Tuan</span> Bui </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/site/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/site/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/site/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/site/projects/">projects </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/site/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/site/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/site/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Flow matching generative model</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#flow-matching-objective">Flow Matching objective</a> </div> <div> <a href="#conditional-flow-matching-objective">Conditional Flow Matching objective</a> </div> <div> <a href="#diffusion-models-are-flow-matching-models">Diffusion models are Flow Matching models</a> </div> </nav> </d-contents> <p>In this post, we explore the theory behind flow-matching generative models and their connection to diffusion models. For more details, refer to <d-cite key="lipman2023"></d-cite>.</p> <p>We begin with $q_0$, a simple distribution that is easy to sample from, such as the standard normal distribution $\mathcal{N}(x;0,\mathbf{I})$. On the other hand, $q_1$ represents an unknown distribution for which we have a set of data samples. In the context of image generative models, \(q_1\) corresponds to the distribution of the image dataset. A generative model defines a mapping $f$ that transforms $q_0$ into $q_1$. In other words, if $x_0 \sim q_0$, then $f(x_0) \sim q_1$.</p> <p>This mapping $f$ can be expressed as an ordinary differential equation (ODE):</p> \[dx=u(t,x)dt\] <p>Here, $t \in [0,1]$, and $u(t,x)$ is a <em>time-dependent vector field</em> $u:[0,1] \times \mathbb{R}^d \to \mathbb{R}^d$.</p> <p>Once the ODE of the target mapping $f$ is learnt, we can sample $q_1$ by solving the ODE with a randomly sampled initial state $x_0 \sim q_0$ and $t$ progresses from 0 to 1. This process moves from $x_0$ to a sample $x_1$ from $q_1$, following the vector field $u(t,x)$, which defines the velocity at each time step $t$. The below image illustrates this process.</p> <div class="row"> <div class="mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/site/assets/img/cfm/flow-480.webp 480w,/site/assets/img/cfm/flow-800.webp 800w,/site/assets/img/cfm/flow-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/site/assets/img/cfm/flow.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The solution of the ODE given an initial state $x_0$ is denoted by a time-dependent function, called <em>flow</em>, $\phi(t,x_0): [0,1] \times \mathbb{R}^d \to \mathbb{R}^d$. We can interpret flow $\phi(t,x_0)$ as the location of point $x_0$ after moving along the vector field $u$ from time $0$ to time $t$. Because initial state $x_0$ is a random variable, $x=\phi(t,x_0)$ is a random variable of some distribution $p_t(x)$. This means the vector field $u(t,x)$ generates a time-dependent probability function $p_t(x): [0,1] \times \mathbb{R}^d \to \mathbb{R}_{&gt;0}$ that satisfies:</p> \[\begin{aligned} p_0(x)&amp;=q_0(x) \\ p_1(x)&amp;=q_1(x) \end{aligned}\] <p>This time-dependent probability function is equivalent to $p_t$ in diffusion models, which is also known as <em>probability path</em>.</p> <h2 id="flow-matching-objective">Flow Matching objective</h2> <p>Consider a target probability path $p(t,x)$ and its associated vector field $u(t,x)$, Flow Matching (FM) objective is defined as follows.</p> \[\mathcal{L}_{FM}(\theta)=\mathbb{E}_{t \sim \mathcal{U}[0,1],x \sim p_t(x)}||v(t,x)-u(t,x)||^2 \tag{1}\] <p>where $\theta$ is the learnable parameters of a neural networks that predicts the vector field $v(t,x)$. Minimizing this objective allows us to train a neural network $v_\theta(t,x)$ to approximate the target vector field $u(t,x)$.</p> <p>Although straightforward, this objective is impractical because computing the target distribution $p(t,x)$ and vector field $u(t,x)$ is intractable.</p> <h2 id="conditional-flow-matching-objective">Conditional Flow Matching objective</h2> <p>Fortunately, the intractable Flow Matching objective can be replaced by a simpler objective, named <em>Conditional Flow Matching</em> (CFM) objective,</p> \[\mathcal{L}_{CFM}(\theta)=\mathbb{E}_{t \sim \mathcal{U}[0,1],x_1 \sim q_1(x), x \sim p_t(x|x_1)}||v(t,x)-u(t,x|x_1)||^2\] <p>where $x_1$ is randomly sampled from data distribution $q_1(x)$, and $u(t,x \vert x_1)$ is the time-dependent vector field associated with the <em>conditional probability path</em> $p_t(x \vert x_1)$.</p> <p>It has been shown that \(\mathcal{L}_{FM}\) and \(\mathcal{L}_{CFM}\) have identical gradients w.r.t $\theta$, meaning they share the same optima. Furthermore, unlike \(\mathcal{L}_{FM}\), \(\mathcal{L}_{CFM}\) is computationally tractable, as we can efficiently sample from $p_t(x \vert x_1)$ and compute $u_t(t,x \vert x_1)$, provided they are appropriately constructed.</p> <h3 id="construction-of-target-p_tx-vert-x_1">Construction of target $p_t(x \vert x_1)$</h3> <p>As the Conditional Flow Matching objective works with any choice of conditional probability path $p_t(x \vert x_1)$, we can choose a Gaussian conditional probability path defined as:</p> \[p_t(x|x_1) = \mathcal{N}(x; \mu_t(x_1), \sigma_t(x_1)^2\mathbf{I}),\] <p>where $\mu_t,\sigma_t$ are the time-dependent mean and standard deviation of the time-dependent Gaussian distribution, respectively. We also set $\mu_0(x_1)=0$ and $\sigma_0(x_1)=1$ for all $x_1$, implying $p_0(x \vert x_1)=\mathcal{N}(x; 0,\mathbf{I})$. As a result of that,</p> \[p_0(x)=\int p_0(x|x_1)q_1(x_1)dx_1=\mathcal{N}(x;0,\mathbf{I}).\] <p>We set $\mu_1(x_1)=x_1$ and $\sigma_1(x_1)=\sigma_\text{min}$, where $\sigma_\text{min}$ is sufficiently small to ensure that $p_1(x \vert x_1)$ becomes a sharply concentrated Gaussian distribution centered at $x_1$. As a result, we obtain:</p> \[p_1(x)=\int p_1(x|x1)q_1(x_1)dx \approx q_1(x).\] <p>By minimizing the $\mathcal{L}_{CFM}$ objective under this choice of $p_t(x \vert x_1)$, we derive a vector field $v(t,x)$ that generates a probability path $p_t(x)$, which approximates the unknown data distribution $q_1(x)$ at $t=1$</p> <h3 id="construction-of-target-u_tx-vert-x_1">Construction of target $u_t(x \vert x_1)$</h3> <p>In addition to the target conditional probability path \(p_t(x \vert x_1)\), the \(\mathcal{L}_{CFM}\) objective also requires a time-dependent conditional vector field \(u(t,x \vert x_1)\) that generates \(p_t(x \vert x_1)\). While there are infinite such vector fields, we can choose the simplest one corresponding to the following conditional <em>flow</em>:</p> \[\phi(t,x|x_1)= \mu_t(x_1) + \sigma_t(x_1)x\] <p>where $x \sim \mathcal{N}(0,\mathbf{I})$. It is straightforward to verify that this conditional flow generates the target conditional probability path $p_t(x \vert x_1)=\mathcal{N}(x; \mu_t(x_1), \sigma_t(x_1)^2\mathbf{I})$.</p> <p>As shown in <d-cite key="lipman2023"></d-cite>, the $\phi(t,x \vert x_1)$ uniquely determines a conditional vector field, which takes the form:</p> \[u(t,x|x_1) = \frac{\sigma_t'(x_1)}{\sigma_t(x_1)}(x-\mu_t(x_1)) + \mu_t'(x_1) \tag{2}\] <h3 id="choice-of-mu_t-and-sigma_t">Choice of $\mu_t$ and $\sigma_t$</h3> <p>Depending on how we define $\mu_t$ and $\sigma_t$, we will have different Gaussian conditional probability paths. Notably, diffusion processes, such as Variance Exploding (VE) or Variance Preserving (VP), are characterized by Gaussian conditional probability paths and therefore can be interpreted as specific choices of $\mu_t$ and $\sigma_t$ within the Conditional Flow Matching framework.</p> <p>As demonstrated in <d-cite key="lipman2023"></d-cite>, the optimal choice of $\mu_t$ and $\sigma_t$ is the one that makes the conditional flow $\phi(t,x \vert x_1)$ a linear interpolation between $x$ and $x_1$.Specifically, they set</p> \[\begin{aligned} \mu_t(x_1) &amp;= tx_1 \\ \sigma_t(x_1) &amp;= 1 - t \\ \end{aligned}\] <p>which leads to</p> \[\phi(t,x|x_1)= tx_1 + (1-t)x\] <p>This special flow is called <em>Optimal Transport flow</em>, and using Equation 2, its corresponding conditional vector field is</p> \[u(t,x|x_1)=\frac{x_1 - x}{1 - t}\] <p>Substituting this into Equation 1, we get:</p> \[\mathcal{L}_{CFM}(\theta)=\mathbb{E}_{t \sim \mathcal{U}[0,1],x_1 \sim q_1(x), x \sim p_t(x|x_1)}\left\|v(t,x)-\frac{x_1 - x}{1 - t}\right\|^2\] <p>while this is already a straightforward loss function that can be implemented and optimized using gradient descent, we can refine it a little more. As $\mu_t(x_1)=tx_1$ and $\sigma_t(x_1)=1 - t$, we have:</p> \[p_t(x|x_1)=\mathcal{N}(x;tx_1,(1-t)^2\mathbf{I})\] <p>which means $x \sim p_t(x \vert x_1)$ is equivalent to $x = tx_1 + (1-t)\epsilon$ where $\epsilon \sim \mathcal{N}(0,\mathbf{I})$. As a result, we can rewrite $\mathcal{L}_{CFM}$ by replacing $x \sim p_t(x \vert x_1)$ with $\epsilon \sim \mathcal{N}(0,\mathbf{I})$ and substituting $tx_1 + (1-t)\epsilon$ for $x$. Specifically,</p> \[\begin{aligned} \mathcal{L}_{CFM}(\theta) &amp;= \mathbb{E}_{t \sim \mathcal{U}[0,1],x_1 \sim q_1(x), \epsilon \sim \mathcal{N}(0,\mathbf{I})} \left\| v(t,tx_1+(1-t)\epsilon)-\frac{x_1 - (tx_1+(1-t)\epsilon)}{1 - t} \right\|^2 \\ &amp;= \mathbb{E}_{t \sim \mathcal{U}[0,1],x_1 \sim q_1(x), \epsilon \sim \mathcal{N}(0,\mathbf{I})} \left\| v(t,tx_1+(1-t)\epsilon)-(x_1-\epsilon) \right\|^2 \end{aligned}\] <p>which is the final loss function to be implemented, and it is the same as the loss function used by Flow Matching models like Stable Diffusion 3 or Flux.</p> <h2 id="diffusion-models-are-flow-matching-models">Diffusion models are Flow Matching models</h2> <p>As we know, the forward process in a diffusion model gradually degrades an observed data point, such as an image, over time by blending it with Gaussian noise. That process is defined by the following formula.</p> \[z_t=\alpha_t \mathbf{x} + \sigma_t \epsilon\] <p>where $t\in[0,1]$, $\mathbf{x}$ is an observed data point, $\epsilon \sim \mathcal{N}(0,\mathbf{I})$, and $\alpha_t$ and $\sigma_t$ are designed such that $\alpha_0 \approx 1, \sigma_0 \approx 0$ and $\alpha_1 \approx 0, \sigma_1 \approx 1$. These time-dependent parameters, $\alpha_t$ and $\sigma_t$, are commonly referred to as the <em>Noise Scheduler</em>.</p> <p>The formula can be interpreted as $z_t$ being a random sample from the Gaussian distribution $\mathcal{N}(z; \alpha_t \mathbf{x}, \sigma_t^2)$, and thereby a diffusion forward process can be characterized by conditional probability path:</p> \[p_t(z|\mathbf{x})=\mathcal{N}(z; \alpha_t \mathbf{x}, \sigma_t^2 \mathbf{I}).\] <p>Recall that the aforementioned Conditional Flow Matching objective constructs a model that are also characterized by a Gaussian conditional probability path of the form:</p> \[p_t(x|x_1) = \mathcal{N}(x; \mu_t(x_1), \psi_t(x_1)^2\mathbf{I}),\] <p>(note that I replaced $\sigma_t$ by $\psi_t$ to avoid confusion)</p> <p>Furthermore, by setting $\mu_t(x_1)=\alpha_{1-t} x_1$ and $\psi_t(x_1)=\sigma_{1-t}$, we obtain the same conditional probability path as in diffusion models. Thus, we can conclude that diffusion models are instances of Flow Matching models.</p> <p>Conversely, we can also represent the Optimal Transport flow model using a diffusion model. In this case, the noise scheduler is defined as:</p> \[\begin{aligned} \alpha_t &amp;= 1-t \\ \sigma_t &amp;= t \end{aligned}\] <p>If we train this diffusion model with a $\epsilon$-prediction denoiser, then the training objective becomes</p> \[\mathcal{L} = \mathbb{E}_{t \sim \mathcal{U}[0,1], \epsilon \sim \mathcal{N}(0,\mathbf{I})} \left( \frac{t}{1-t}\right)^2 ||\hat{\epsilon}-\epsilon||^2,\] <p>which is derived by rewriting $\mathcal{L}_{CFM}$ as mean squared error on $\epsilon$ with a specific weighting.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/site/assets/bibliography/2018-12-22-distill.bib"></d-bibliography> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Minh-Tuan Bui. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/site/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/site/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/site/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/site/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/site/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/site/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/site/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/site/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/site/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/site/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/site/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/site/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/site/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/site/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/site/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/site/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/site/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/site/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/site/assets/js/search-data.js"></script> <script src="/site/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>